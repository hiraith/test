{"remainingRequest":"C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\src\\components\\working\\WorkingStatus.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\src\\components\\working\\WorkingStatus.vue","mtime":1581501064170},{"path":"C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\ciz\\IdeaProjects\\UpfficeFront\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoubGlzdCB7CiAgICB0ZXh0LWFsaWduOiBsZWZ0OwogICAgbWF4LXdpZHRoOiA0NTBweDsKICAgIG1hcmdpbjogYXV0bzsKfQo="},{"version":3,"sources":["WorkingStatus.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkSA;AACA;AACA;AACA;AACA","file":"WorkingStatus.vue","sourceRoot":"src/components/working","sourcesContent":["<template>\r\n    <div class=\"list row\">\r\n        <subMenu></subMenu>\r\n        <div class=\"col-md-12\">\r\n            <h4>근태</h4>\r\n            <h2>\r\n                <button class=\"btn btn-success\" v-on:click=\"onClickPrev(currentMonth)\">◀</button>\r\n                {{currentYear}}.{{currentMonth}}\r\n                <button class=\"btn btn-success\" v-on:click=\"onClickNext(currentMonth)\">▶</button>\r\n            </h2>\r\n\r\n            <div class=\"progress\">\r\n                <div class=\"progress-bar\" role=\"progressbar\" :style=\"{width: barWidth}\" aria-valuenow=\"25\" aria-valuemin=\"0\"\r\n                     aria-valuemax=\"100\"></div>\r\n            </div>\r\n            필요 근무 시간:{{monthTime}}시간<br>\r\n            실제 근무 시간:{{workingTime}}\r\n            <button v-if=\"weeks.week1.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week1.show = !weeks.week1.show\">\r\n                1주차 ▲\r\n            </button>\r\n            <button v-else=\"weeks.week1.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week1.show = !weeks.week1.show\">\r\n                1주차 ▼\r\n            </button>\r\n            <table v-if=\"weeks.week1.show\" class=\"table table-hover\">\r\n                <thead>\r\n                <tr class=\"table-primary\">\r\n                    <td>날짜</td>\r\n                    <td>출근시각</td>\r\n                    <td>퇴근시각</td>\r\n                    <td>근무시간</td>\r\n                </tr>\r\n                </thead>\r\n                <tr v-for=\"(working, index) in weeks.week1.workings\" :key=\"index\">\r\n                    <td>{{working.workingDate}}</td>\r\n                    <td>{{working.workingIn}}</td>\r\n                    <td>{{working.workingOut}}</td>\r\n                    <td>{{working.workingTime}}</td>\r\n                </tr>\r\n            </table>\r\n            <button v-if=\"weeks.week2.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week2.show = !weeks.week2.show\">\r\n                2주차 ▲\r\n            </button>\r\n            <button v-else=\"weeks.week2.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week2.show = !weeks.week2.show\">\r\n                2주차 ▼\r\n            </button>\r\n            <table v-if=\"weeks.week2.show\" class=\"table table-hover\">\r\n                <thead>\r\n                <tr class=\"table-primary\">\r\n                    <td>날짜</td>\r\n                    <td>출근시각</td>\r\n                    <td>퇴근시각</td>\r\n                    <td>근무시간</td>\r\n                </tr>\r\n                </thead>\r\n                <tr v-for=\"(working, index) in weeks.week2.workings\" :key=\"index\">\r\n                    <td>{{working.workingDate}}</td>\r\n                    <td>{{working.workingIn}}</td>\r\n                    <td>{{working.workingOut}}</td>\r\n                    <td>{{working.workingTime}}</td>\r\n                </tr>\r\n            </table>\r\n            <button v-if=\"weeks.week3.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week3.show = !weeks.week3.show\">\r\n                3주차 ▲\r\n            </button>\r\n            <button v-else=\"weeks.week3.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week3.show = !weeks.week3.show\">\r\n                3주차 ▼\r\n            </button>\r\n            <table v-if=\"weeks.week3.show\" class=\"table table-hover\">\r\n                <thead>\r\n                <tr class=\"table-primary\">\r\n                    <td>날짜</td>\r\n                    <td>출근시각</td>\r\n                    <td>퇴근시각</td>\r\n                    <td>근무시간</td>\r\n                </tr>\r\n                </thead>\r\n                <tr v-for=\"(working, index) in weeks.week3.workings\" :key=\"index\">\r\n                    <td>{{working.workingDate}}</td>\r\n                    <td>{{working.workingIn}}</td>\r\n                    <td>{{working.workingOut}}</td>\r\n                    <td>{{working.workingTime}}</td>\r\n                </tr>\r\n            </table>\r\n            <button v-if=\"weeks.week4.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week4.show = !weeks.week4.show\">\r\n                4주차 ▲\r\n            </button>\r\n            <button v-else=\"weeks.week4.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week4.show = !weeks.week4.show\">\r\n                4주차 ▼\r\n            </button>\r\n            <table v-if=\"weeks.week4.show\" class=\"table table-hover\">\r\n                <thead>\r\n                <tr class=\"table-primary\">\r\n                    <td>날짜</td>\r\n                    <td>출근시각</td>\r\n                    <td>퇴근시각</td>\r\n                    <td>근무시간</td>\r\n                </tr>\r\n                </thead>\r\n                <tr v-for=\"(working, index) in weeks.week4.workings\" :key=\"index\">\r\n                    <td>{{working.workingDate}}</td>\r\n                    <td>{{working.workingIn}}</td>\r\n                    <td>{{working.workingOut}}</td>\r\n                    <td>{{working.workingTime}}</td>\r\n                </tr>\r\n            </table>\r\n            <button v-if=\"weeks.week5.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week5.show = !weeks.week5.show\">\r\n                5주차 ▲\r\n            </button>\r\n            <button v-else=\"weeks.week5.show\" class=\"btn btn-success btn-lg btn-block\" v-on:click=\"weeks.week5.show = !weeks.week5.show\">\r\n                5주차 ▼\r\n            </button>\r\n            <table v-if=\"weeks.week5.show\" class=\"table table-hover\">\r\n                <thead>\r\n                <tr class=\"table-primary\">\r\n                    <td>날짜</td>\r\n                    <td>출근시각</td>\r\n                    <td>퇴근시각</td>\r\n                    <td>근무시간</td>\r\n                </tr>\r\n                </thead>\r\n                <tr v-for=\"(working, index) in weeks.week5.workings\" :key=\"index\">\r\n                    <td>{{working.workingDate}}</td>\r\n                    <td>{{working.workingIn}}</td>\r\n                    <td>{{working.workingOut}}</td>\r\n                    <td>{{working.workingTime}}</td>\r\n                </tr>\r\n            </table>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    import http from \"../../http-common\";\r\n    import WorkingSubMenu from \"./WorkingSubMenu\";\r\n\r\n    export default {\r\n        name: \"working-status\",\r\n        data() {\r\n            return {\r\n                empId: '',\r\n                currentYear: new Date().getFullYear(),\r\n                currentMonth: new Date().getMonth() + 1,\r\n                weeks: {\r\n                    week1: {workings: [], show: false},\r\n                    week2: {workings: [], show: false},\r\n                    week3: {workings: [], show: false},\r\n                    week4: {workings: [], show: false},\r\n                    week5: {workings: [], show: false}\r\n                },\r\n                monthTime:'',\r\n                workingTime:'',\r\n                barWidth:'0%',\r\n                show: false\r\n            };\r\n        },// End - data\r\n        components: {\r\n            subMenu: WorkingSubMenu\r\n        },// End - components\r\n        methods: {\r\n            /* eslint-disable no-console */\r\n            readWorkings(currentYear, currentMonth) {// 근태기록을 조회하는 메소드\r\n                let workings = [];\r\n                let moment = require('moment');\r\n                let start = moment(currentYear + \"-\" + currentMonth).startOf('month').format('YYYY-MM-DD');\r\n                let end = moment(currentYear + \"-\" + currentMonth).endOf('month').format('YYYY-MM-DD');\r\n\r\n                this.calcMonthTime(moment(currentYear + \"-\" + currentMonth));\r\n\r\n                http\r\n                    .get(\"/working/workings/\" + this.empId + \"?start=\" + start + \"&end=\" + end)\r\n                    .then(response => {\r\n                        // this.workings = response.data; // JSON are parsed automatically.\r\n                        workings = response.data;\r\n                        console.log(response.data);\r\n                        this.divideWeekly(workings);\r\n                        this.calcWorkingTime(workings);\r\n                    })\r\n                    .catch(e => {\r\n                        console.log(e);\r\n                    });\r\n            },// End - readWorkings(currentYear,currentMonth)\r\n            calcMonthTime(date){//조회 중인 달에 근무해야 할 시간을 계산\r\n                let conut=0;\r\n                let startDate = date.clone().startOf('month');\r\n                let diff=startDate.diff(date.clone().endOf('month'),'day');\r\n                for(; diff!==1; diff++){\r\n                     if(startDate.day()!==0&&startDate.day()!==6) {\r\n                         conut++;\r\n                     }\r\n                    startDate=startDate.add(1,'day');\r\n                }\r\n               this.monthTime=conut*8;\r\n            },// End - calcMonthTime(date)\r\n            calcWorkingTime(workings) {//현재 조희 중인 달의 근무시간의 총 합을 구하는 메소드\r\n                let moment = require('moment');\r\n                let totalHour = 0;\r\n                let totalMin = 0;\r\n                let totalSec = 0;\r\n\r\n                for (let i = 0; i < workings.length; i++) {\r\n                    let working = workings[i].workingDate + \" \" + workings[i].workingTime;\r\n                    let hour = Number.isNaN(Number(moment(working).format('h'))) ? 0 : Number(moment(working).format('h'));\r\n                    totalHour += (hour === 12)? 0 : hour;\r\n                    totalMin += Number.isNaN(Number(moment(working).format('h'))) ? 0 : Number(moment(working).format('m'));\r\n                    totalSec += Number.isNaN(Number(moment(working).format('h'))) ? 0 : Number(moment(working).format('s'));\r\n                }\r\n\r\n                totalHour += Math.floor(totalMin / 60);\r\n                totalMin = totalMin % 60 + Math.floor(totalSec / 60);\r\n                totalSec = totalSec % 60;\r\n\r\n                this.workingTime=totalHour+\"시간\"+totalMin+\"분\";\r\n                this.setBarWidth((totalHour*60+totalMin),(this.monthTime*60));\r\n            },// End - calcWorkingTime(workings)\r\n            setBarWidth(workingMin,monthMin){ // 조회하는 달 근무시간에 따라 막대바의 길이를 조절하는 메소드\r\n                this.barWidth=Math.floor(workingMin/monthMin*100)+'%';\r\n            },// End - setBarWidth(workingMin,monthMin)\r\n            divideWeekly(workings) { // 근태기록을 주차별로 나누는 메소드\r\n\r\n                //각 주차의 근태기록 초기화\r\n                this.weeks.week1.workings = [];\r\n                this.weeks.week2.workings = [];\r\n                this.weeks.week3.workings = [];\r\n                this.weeks.week4.workings = [];\r\n\r\n                let moment = require('moment');\r\n                let i = 0;\r\n                for (let j = 0; i < workings.length && this.weekOfMonth(moment(workings[i].workingDate.toString())) === 1; j++) {\r\n                    this.weeks.week1.workings[j] = workings[i];\r\n                    i++;\r\n                }\r\n                for (let j = 0; i < workings.length && this.weekOfMonth(moment(workings[i].workingDate.toString())) === 2; j++) {\r\n                    this.weeks.week2.workings[j] = workings[i];\r\n                    i++;\r\n                }\r\n                for (let j = 0; i < workings.length && this.weekOfMonth(moment(workings[i].workingDate.toString())) === 3; j++) {\r\n                    this.weeks.week3.workings[j] = workings[i];\r\n                    i++;\r\n                }\r\n                for (let j = 0; i < workings.length && this.weekOfMonth(moment(workings[i].workingDate.toString())) === 4; j++) {\r\n                    this.weeks.week4.workings[j] = workings[i];\r\n                    i++;\r\n                }\r\n                for (let j = 0; i < workings.length; j++) {\r\n                    this.weeks.week5.workings[j] = workings[i];\r\n                    i++;\r\n                }\r\n            },// End -  divideWeekly(workings)\r\n            weekOfMonth(date) {// 특정 날짜가 달의 몇 번째 주에 해당하는 지 반환 하는 메소드\r\n                const firstDayOfMonth = date.clone().startOf('month');\r\n                const firstDayOfWeek = firstDayOfMonth.clone().startOf('week');\r\n\r\n                const offset = firstDayOfMonth.diff(firstDayOfWeek, 'days');\r\n\r\n                return Math.ceil((date.date() + offset) / 7);\r\n            },// End -  weekOfMonth(date)\r\n            onClickPrev(month) {// 현재조회 중인 달의 이전 달을 조회\r\n                month--;\r\n                if (month <= 0) {\r\n                    this.currentMonth = 12;\r\n                    this.currentYear -= 1;\r\n                } else {\r\n                    this.currentMonth -= 1;\r\n                }\r\n                this.readWorkings(this.currentYear, this.currentMonth);\r\n            },// End -  onClickPrev (month)\r\n            onClickNext(month) {//현재조회 중인 달의 다음 달을 조회\r\n                month++;\r\n                if (month > 12) {\r\n                    this.currentMonth = 1;\r\n                    this.currentYear += 1;\r\n                } else {\r\n                    this.currentMonth += 1;\r\n                }\r\n                this.readWorkings(this.currentYear, this.currentMonth);\r\n            }// End -  onClickNext (month)\r\n            /* eslint-enable no-console */\r\n        },// End - methods\r\n        mounted() {// mounted 될때 로그인이 되어있는 상태라면\r\n            if (sessionStorage.length > 0) { // 현재 sessionStorage에 요소가 존재하는 상태일 때(로그인이 되어서 sessionStorage에 저장된 상태일 때)\r\n                this.empId = sessionStorage.getItem(\"login_id\");\r\n                this.readWorkings(this.currentYear, this.currentMonth);\r\n            } else {\r\n                this.$router.push(\"/\");\r\n            }\r\n        } // End - mounted()\r\n    };// End - export default\r\n</script>\r\n\r\n<style>\r\n    .list {\r\n        text-align: left;\r\n        max-width: 450px;\r\n        margin: auto;\r\n    }\r\n</style>\r\n"]}]}